
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Kubernetes Configuration Audit Report</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
        <style>
            body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; margin: 0; background-color: #f4f7f9; color: #333; }
            .container { max-width: 1400px; margin: 20px auto; padding: 20px; background-color: #fff; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-radius: 8px; }
            h1, h2 { color: #2c3e50; border-bottom: 2px solid #e0e0e0; padding-bottom: 10px; }
            .header-controls { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px; }
            .export-buttons button { margin-left: 10px; }
            .summary { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; padding: 20px 0; margin-bottom: 20px; border-radius: 8px; background-color: #ecf0f1; }
            .summary-box { text-align: center; padding: 10px 20px; border-radius: 5px; color: white; flex: 1; min-width: 120px; }
            .summary-box .count { font-size: 2em; font-weight: bold; }
            .summary-box .label { font-size: 1em; text-transform: uppercase; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; table-layout: fixed; }
            th, td { padding: 12px; border: 1px solid #ddd; text-align: left; word-wrap: break-word; }
            th { background-color: #34495e; color: white; font-weight: bold; }
            tr:nth-child(even) { background-color: #f2f2f2; }
            .severity-badge { color: white; padding: 5px 10px; border-radius: 12px; font-size: 0.9em; font-weight: bold; text-align: center; display: inline-block; min-width: 80px; }
            .controls { display: flex; gap: 20px; margin-bottom: 20px; align-items: center; flex-wrap: wrap; }
            #searchInput { width: 100%; max-width: 300px; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 1em; }
            .filter-buttons button, .export-buttons button { padding: 8px 15px; border: none; border-radius: 4px; cursor: pointer; background-color: #bdc3c7; color: #34495e; font-weight: bold; }
            .filter-buttons button.active { background-color: #3498db; color: white; }
            #downloadExcelBtn { background-color: #27ae60; color: white; }
            #downloadPdfBtn { background-color: #c0392b; color: white; }
            .footer { text-align: center; margin-top: 20px; font-size: 0.9em; color: #777; }
            .messages { list-style-type: disc; padding-left: 20px; margin: 5px 0 0 0; }
        </style>
    </head>
    <body>
        <div class="container" id="reportContainer">
            <div class="header-controls">
                <h1>Kubernetes Configuration Audit Report</h1>
                <div class="export-buttons">
                    <button id="downloadExcelBtn" onclick="downloadExcel()">Download Excel</button>
                    <button id="downloadPdfBtn" onclick="downloadPDF()">Download PDF</button>
                </div>
            </div>
            <p><strong>Generated on:</strong> 2025-08-14 16:36:22</p>
            <p><strong>Resource Name:</strong> replicaset-dvwa-598b776995</p>
            <p><strong>Scanner:</strong> Trivy v0.28.0</p>
            <h2>Summary of Checks</h2>
            <div class="summary"><div class="summary-box" style="background-color: #800000;"><div class="count">0</div><div class="label">Critical</div></div><div class="summary-box" style="background-color: #FF0000;"><div class="count">3</div><div class="label">High</div></div><div class="summary-box" style="background-color: #FFA500;"><div class="count">6</div><div class="label">Medium</div></div><div class="summary-box" style="background-color: #008000;"><div class="count">10</div><div class="label">Low</div></div></div>
            <h2>Audit Check Details</h2>
            <div class="controls">
                <input type="text" id="searchInput" onkeyup="filterTable()" placeholder="Search checks...">
                <div class="filter-buttons" id="filterButtons">
                    <button class="active" onclick="toggleFilter('CRITICAL', this)">Critical</button>
                    <button class="active" onclick="toggleFilter('HIGH', this)">High</button>
                    <button class="active" onclick="toggleFilter('MEDIUM', this)">Medium</button>
                    <button class="active" onclick="toggleFilter('LOW', this)">Low</button>
                    <button class="active" onclick="toggleFilter('UNKNOWN', this)">Unknown</button>
                </div>
            </div>
            <table id="vulnTable">
                <colgroup><col style="width: 10%;"><col style="width: 10%;"><col style="width: 20%;"><col style="width: 30%;"><col style="width: 30%;"></colgroup>
                <thead><tr><th>Check ID</th><th>Severity</th><th>Title</th><th>Description & Messages</th><th>Remediation</th></tr></thead>
                <tbody>
            <tr>
                <td>KSV014</td>
                <td><span class="severity-badge" style="background-color: #FF0000;">HIGH</span></td>
                <td>Root file system is not read-only</td>
                <td><p>An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.</p><ul class='messages'><li>Container 'dvwa' of ReplicaSet 'dvwa-598b776995' should set 'securityContext.readOnlyRootFilesystem' to true</li></ul></td>
                <td>Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.</td>
            </tr>
            
            <tr>
                <td>KSV118</td>
                <td><span class="severity-badge" style="background-color: #FF0000;">HIGH</span></td>
                <td>Default security context configured</td>
                <td><p>Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.</p><ul class='messages'><li>container dvwa-598b776995 in dvwa namespace is using the default security context</li></ul></td>
                <td>To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.</td>
            </tr>
            
            <tr>
                <td>KSV118</td>
                <td><span class="severity-badge" style="background-color: #FF0000;">HIGH</span></td>
                <td>Default security context configured</td>
                <td><p>Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.</p><ul class='messages'><li>replicaset dvwa-598b776995 in dvwa namespace is using the default security context, which allows root privileges</li></ul></td>
                <td>To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.</td>
            </tr>
            
            <tr>
                <td>KSV0125</td>
                <td><span class="severity-badge" style="background-color: #FFA500;">MEDIUM</span></td>
                <td>Restrict container images to trusted registries</td>
                <td><p>Ensure that all containers use images only from trusted registry domains.</p><ul class='messages'><li>Container dvwa in replicaset dvwa-598b776995 (namespace: dvwa) uses an image from an untrusted registry.</li></ul></td>
                <td>Use images from trusted registries.</td>
            </tr>
            
            <tr>
                <td>KSV013</td>
                <td><span class="severity-badge" style="background-color: #FFA500;">MEDIUM</span></td>
                <td>Image tag ":latest" used</td>
                <td><p>It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.</p><ul class='messages'><li>Container 'dvwa' of ReplicaSet 'dvwa-598b776995' should specify an image tag</li></ul></td>
                <td>Use a specific container image tag that is not 'latest'.</td>
            </tr>
            
            <tr>
                <td>KSV104</td>
                <td><span class="severity-badge" style="background-color: #FFA500;">MEDIUM</span></td>
                <td>Seccomp policies disabled</td>
                <td><p>A program inside the container can bypass Seccomp protection policies.</p><ul class='messages'><li>container "dvwa" of replicaset "dvwa-598b776995" in "dvwa" namespace should specify a seccomp profile</li></ul></td>
                <td>Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards</td>
            </tr>
            
            <tr>
                <td>KSV012</td>
                <td><span class="severity-badge" style="background-color: #FFA500;">MEDIUM</span></td>
                <td>Runs as root user</td>
                <td><p>Force the running image to run as a non-root user to ensure least privileges.</p><ul class='messages'><li>Container 'dvwa' of ReplicaSet 'dvwa-598b776995' should set 'securityContext.runAsNonRoot' to true</li></ul></td>
                <td>Set 'containers[].securityContext.runAsNonRoot' to true.</td>
            </tr>
            
            <tr>
                <td>KSV001</td>
                <td><span class="severity-badge" style="background-color: #FFA500;">MEDIUM</span></td>
                <td>Can elevate its own privileges</td>
                <td><p>A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.</p><ul class='messages'><li>Container 'dvwa' of ReplicaSet 'dvwa-598b776995' should set 'securityContext.allowPrivilegeEscalation' to false</li></ul></td>
                <td>Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.</td>
            </tr>
            
            <tr>
                <td>KSV117</td>
                <td><span class="severity-badge" style="background-color: #FFA500;">MEDIUM</span></td>
                <td>Prevent binding to privileged ports</td>
                <td><p>The ports which are lower than 1024 receive and transmit various sensitive and privileged data. Allowing containers to use them can bring serious implications.</p><ul class='messages'><li>replicaset dvwa-598b776995 in dvwa namespace should not set spec.template.spec.containers.ports.containerPort to less than 1024</li></ul></td>
                <td>Do not map the container ports to privileged host ports when starting a container.</td>
            </tr>
            
            <tr>
                <td>KSV106</td>
                <td><span class="severity-badge" style="background-color: #008000;">LOW</span></td>
                <td>Container capabilities must only include NET_BIND_SERVICE</td>
                <td><p>Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.</p><ul class='messages'><li>container should drop all</li></ul></td>
                <td>Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.</td>
            </tr>
            
            <tr>
                <td>KSV021</td>
                <td><span class="severity-badge" style="background-color: #008000;">LOW</span></td>
                <td>Runs with GID <= 10000</td>
                <td><p>Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.</p><ul class='messages'><li>Container 'dvwa' of ReplicaSet 'dvwa-598b776995' should set 'securityContext.runAsGroup' > 10000</li></ul></td>
                <td>Set 'containers[].securityContext.runAsGroup' to an integer > 10000.</td>
            </tr>
            
            <tr>
                <td>KSV018</td>
                <td><span class="severity-badge" style="background-color: #008000;">LOW</span></td>
                <td>Memory not limited</td>
                <td><p>Enforcing memory limits prevents DoS via resource exhaustion.</p><ul class='messages'><li>Container 'dvwa' of ReplicaSet 'dvwa-598b776995' should set 'resources.limits.memory'</li></ul></td>
                <td>Set a limit value under 'containers[].resources.limits.memory'.</td>
            </tr>
            
            <tr>
                <td>KSV016</td>
                <td><span class="severity-badge" style="background-color: #008000;">LOW</span></td>
                <td>Memory requests not specified</td>
                <td><p>When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.</p><ul class='messages'><li>Container 'dvwa' of ReplicaSet 'dvwa-598b776995' should set 'resources.requests.memory'</li></ul></td>
                <td>Set 'containers[].resources.requests.memory'.</td>
            </tr>
            
            <tr>
                <td>KSV020</td>
                <td><span class="severity-badge" style="background-color: #008000;">LOW</span></td>
                <td>Runs with UID <= 10000</td>
                <td><p>Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.</p><ul class='messages'><li>Container 'dvwa' of ReplicaSet 'dvwa-598b776995' should set 'securityContext.runAsUser' > 10000</li></ul></td>
                <td>Set 'containers[].securityContext.runAsUser' to an integer > 10000.</td>
            </tr>
            
            <tr>
                <td>KSV011</td>
                <td><span class="severity-badge" style="background-color: #008000;">LOW</span></td>
                <td>CPU not limited</td>
                <td><p>Enforcing CPU limits prevents DoS via resource exhaustion.</p><ul class='messages'><li>Container 'dvwa' of ReplicaSet 'dvwa-598b776995' should set 'resources.limits.cpu'</li></ul></td>
                <td>Set a limit value under 'containers[].resources.limits.cpu'.</td>
            </tr>
            
            <tr>
                <td>KSV015</td>
                <td><span class="severity-badge" style="background-color: #008000;">LOW</span></td>
                <td>CPU requests not specified</td>
                <td><p>When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.</p><ul class='messages'><li>Container 'dvwa' of ReplicaSet 'dvwa-598b776995' should set 'resources.requests.cpu'</li></ul></td>
                <td>Set 'containers[].resources.requests.cpu'.</td>
            </tr>
            
            <tr>
                <td>KSV004</td>
                <td><span class="severity-badge" style="background-color: #008000;">LOW</span></td>
                <td>Default capabilities: some containers do not drop any</td>
                <td><p>Security best practices require containers to run with minimal required capabilities.</p><ul class='messages'><li>Container 'dvwa' of 'replicaset' 'dvwa-598b776995' in 'dvwa' namespace should set securityContext.capabilities.drop</li></ul></td>
                <td>Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'</td>
            </tr>
            
            <tr>
                <td>KSV030</td>
                <td><span class="severity-badge" style="background-color: #008000;">LOW</span></td>
                <td>Runtime/Default Seccomp profile not set</td>
                <td><p>According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.</p><ul class='messages'><li>Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'</li></ul></td>
                <td>Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.</td>
            </tr>
            
            <tr>
                <td>KSV003</td>
                <td><span class="severity-badge" style="background-color: #008000;">LOW</span></td>
                <td>Default capabilities: some containers do not drop all</td>
                <td><p>The container should drop all default capabilities and add only those that are needed for its execution.</p><ul class='messages'><li>Container 'dvwa' of ReplicaSet 'dvwa-598b776995' should add 'ALL' to 'securityContext.capabilities.drop'</li></ul></td>
                <td>Add 'ALL' to containers[].securityContext.capabilities.drop.</td>
            </tr>
            </tbody>
            </table>
            <div class="footer">Report generated by Python script.</div>
        </div>
        <script>
            const activeFilters = new Set(['CRITICAL', 'HIGH', 'MEDIUM', 'LOW', 'UNKNOWN']);
            function toggleFilter(severity, btnElement) { btnElement.classList.toggle('active'); if (activeFilters.has(severity)) activeFilters.delete(severity); else activeFilters.add(severity); filterTable(); }
            function filterTable() { const searchInput = document.getElementById('searchInput').value.toLowerCase(); const table = document.getElementById('vulnTable'); const tr = table.getElementsByTagName('tr'); for (let i = 1; i < tr.length; i++) { const row = tr[i]; const severityCell = row.getElementsByTagName('td')[1]; if (severityCell) { const severity = severityCell.querySelector('.severity-badge').textContent.toUpperCase(); const rowText = row.textContent.toLowerCase(); const severityMatch = activeFilters.has(severity); const searchMatch = rowText.includes(searchInput); row.style.display = (severityMatch && searchMatch) ? "" : "none"; } } }
            document.addEventListener('DOMContentLoaded', filterTable);
            function downloadPDF() { const element = document.getElementById('reportContainer'); const opt = { margin: 0.5, filename: 'config_audit_report.pdf', image: { type: 'jpeg', quality: 0.98 }, html2canvas: { scale: 2, useCORS: true }, jsPDF: { unit: 'in', format: 'letter', orientation: 'landscape' } }; document.querySelectorAll('.controls, .export-buttons').forEach(el => el.style.display = 'none'); html2pdf().set(opt).from(element).save().then(() => { document.querySelectorAll('.controls, .export-buttons').forEach(el => el.style.display = 'flex'); }); }
            function downloadExcel() { const table = document.getElementById('vulnTable'); const rows = table.querySelectorAll('tr'); const data = []; const headers = []; rows[0].querySelectorAll('th').forEach(th => headers.push(th.innerText)); data.push(headers); for (let i = 1; i < rows.length; i++) { if (rows[i].style.display !== 'none') { const row = []; rows[i].querySelectorAll('td').forEach(td => row.push(td.innerText)); data.push(row); } } const worksheet = XLSX.utils.aoa_to_sheet(data); const workbook = XLSX.utils.book_new(); XLSX.utils.book_append_sheet(workbook, worksheet, "Config Audits"); XLSX.writeFile(workbook, "config_audit_report.xlsx"); }
        </script>
    </body>
    </html>
    